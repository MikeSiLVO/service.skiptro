# service.skiptro

Kodi add-on that shows a skip button during TV show intros.

If you find this useful, [buy me a coffee](https://ko-fi.com/mikesilvo) ☕

Works with [Skiptro](https://github.com/MikeSiLVO/skiptro-releases), which scans your library and creates `.skiptro.json` files with intro timing data.

## Installation

1. Download the latest zip from [Releases](https://github.com/MikeSiLVO/service.skiptro/releases)
2. In Kodi: Settings > Add-ons > Install from zip file
3. Select the downloaded zip

## How it works

The add-on runs in the background during video playback. When it finds a `.skiptro.json` file next to the video being played, it shows a "Skip Intro" button when playback reaches the intro region. The button auto-dismisses if not pressed (default 10 seconds, configurable in add-on settings).

## Skip data format

The add-on reads `.skiptro.json` files placed next to each video file:

```
TV Show/Season 1/Episode 01.mkv
TV Show/Season 1/Episode 01.skiptro.json
```

```json
{
  "intro": { "start": 0, "end": 87.5 }
}
```

## Window properties

The add-on sets properties on the Home window that skins can use to show/hide elements:

| Property | Set when |
|----------|----------|
| `Skiptro.HasData` | A `.skiptro.json` file was found for the current video |
| `Skiptro.HasIntro` | The skip data contains intro timestamps |
| `Skiptro.InIntro` | Playback is currently within the intro region |
| `Skiptro.DialogVisible` | The skip dialog is currently on screen |
| `Skiptro.Skipping` | The add-on has initiated a seek (set before seek, cleared when seek and any post-seek caching have fully settled) |

Use these in skin visibility conditions, e.g. `!String.IsEmpty(Window(Home).Property(Skiptro.InIntro))`.

To hide skin elements during add-on initiated skips (e.g. seekbar, OSD overlays), add a visibility condition that checks `Skiptro.Skipping` and `Skiptro.DialogVisible`:

```
String.IsEmpty(Window(Home).Property(Skiptro.Skipping)) + String.IsEmpty(Window(Home).Property(Skiptro.DialogVisible))
```

This can be added as a separate `<visible>` tag alongside existing conditions. The `Skipping` property covers the entire seek lifecycle — from the moment the skip is initiated until `Player.HasPerformedSeek(2)` and `Player.Caching` are both false — so no additional seek/caching conditions are needed.

## Skinning

The skip dialog uses Kodi's `WindowXMLDialog`, so skins can provide their own version of the dialog XML. Place a file named `service.skiptro-SkipDialog.xml` in your skin's XML directory (e.g. `1080i/`) and it will be used instead of the add-on's built-in default.

The dialog uses these control IDs:

| ID | Purpose |
|----|---------|
| 101 | Skip Intro button |

## Settings

| Setting | Default | Description |
|---------|---------|-------------|
| Automatically skip intros | Off | Skip intros without showing a dialog |
| Auto-close timeout | 10 seconds | How long the skip button stays on screen before dismissing |

## Requirements

- Kodi 19 (Matrix) or later
- `.skiptro.json` files generated by [Skiptro](https://github.com/MikeSiLVO/skiptro-releases)
